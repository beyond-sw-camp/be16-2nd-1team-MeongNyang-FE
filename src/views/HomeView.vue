<template>
  <div class="home-view">
    <!-- ë¡œê·¸ì¸í•˜ì§€ ì•Šì€ ê²½ìš°: ê¸°ì¡´ í™ˆí˜ì´ì§€ -->
    <template v-if="!isLoggedIn">
      <!-- íˆì–´ë¡œ ì„¹ì…˜ -->
      <section class="hero-section">
      <div class="hero-background">
        <div class="hero-overlay"></div>
        <div class="floating-shapes">
          <div class="shape shape-1"></div>
          <div class="shape shape-2"></div>
          <div class="shape shape-3"></div>
        </div>
      </div>
      
      <div class="hero-content">
        <div class="hero-text">
          <h1 class="hero-title">
            <span class="title-line">ë©ë©ëƒ¥ëƒ¥ì—</span>
            <span class="title-line">ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤!</span>
          </h1>
          <p class="hero-subtitle">
            ë°˜ë ¤ë™ë¬¼ê³¼ í•¨ê»˜í•˜ëŠ” ì¦ê±°ìš´ ì»¤ë®¤ë‹ˆí‹°ì…ë‹ˆë‹¤.
            <br>ë‹¤ì´ì–´ë¦¬, ë§ˆì¼“í”Œë ˆì´ìŠ¤, ì±„íŒ… ë“± ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì´ìš©í•´ë³´ì„¸ìš”!
          </p>
          
          <div class="hero-actions">
            <v-btn
              v-if="!isLoggedIn"
              size="x-large"
              variant="elevated"
              class="hero-btn login-btn"
              @click="openAuthModal('login')"
            >
              <v-icon class="me-3">mdi-login</v-icon>
              ë¡œê·¸ì¸
            </v-btn>
            <v-btn
              v-if="!isLoggedIn"
              size="x-large"
              variant="outlined"
              class="hero-btn register-btn"
              @click="openAuthModal('register')"
            >
              <v-icon class="me-3">mdi-account-plus</v-icon>
              íšŒì›ê°€ì…
            </v-btn>
            <v-btn
              v-if="isLoggedIn"
              size="x-large"
              variant="elevated"
              class="hero-btn dashboard-btn"
              @click="$router.push('/dashboard')"
            >
              <v-icon class="me-3">mdi-view-dashboard</v-icon>
              ëŒ€ì‹œë³´ë“œë¡œ ì´ë™
            </v-btn>
          </div>
        </div>
        
        <div class="hero-visual">
          <div class="pet-illustrations">
            <div class="pet pet-dog">
              <span class="emoji">ğŸ•</span>
            </div>
            <div class="pet pet-cat">
              <span class="emoji">ğŸ±</span>
            </div>
            <div class="pet pet-bird">
              <span class="emoji">ğŸ¦œ</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ê¸°ëŠ¥ ì†Œê°œ ì„¹ì…˜ -->
    <section class="features-section">
      <div class="container">
        <h2 class="section-title">ì£¼ìš” ê¸°ëŠ¥</h2>
        <div class="features-grid">
          <div class="feature-card palette-pet">
            <div class="feature-icon">
              <v-icon size="48">mdi-paw</v-icon>
            </div>
            <h3 class="feature-title">ë°˜ë ¤ë™ë¬¼ ê´€ë¦¬</h3>
            <p class="feature-description">
              ë°˜ë ¤ë™ë¬¼ì˜ ì •ë³´ë¥¼ ì²´ê³„ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê³  ê±´ê°• ìƒíƒœë¥¼ ì¶”ì í•´ë³´ì„¸ìš”.
            </p>
          </div>
          
          <div class="feature-card palette-diary">
            <div class="feature-icon">
              <v-icon size="48">mdi-book-open</v-icon>
            </div>
            <h3 class="feature-title">ë‹¤ì´ì–´ë¦¬</h3>
            <p class="feature-description">
              ë°˜ë ¤ë™ë¬¼ê³¼ì˜ íŠ¹ë³„í•œ ìˆœê°„ë“¤ì„ ê¸°ë¡í•˜ê³  ì¶”ì–µì„ ë‚¨ê²¨ë³´ì„¸ìš”.
            </p>
          </div>
          
          <div class="feature-card palette-market">
            <div class="feature-icon">
              <v-icon size="48">mdi-store</v-icon>
            </div>
            <h3 class="feature-title">ë§ˆì¼“í”Œë ˆì´ìŠ¤</h3>
            <p class="feature-description">
              ë°˜ë ¤ë™ë¬¼ ìš©í’ˆì„ ê±°ë˜í•˜ê³  í•„ìš”í•œ ë¬¼ê±´ì„ ì°¾ì•„ë³´ì„¸ìš”.
            </p>
          </div>
          
          <div class="feature-card palette-community">
            <div class="feature-icon">
              <v-icon size="48">mdi-chat</v-icon>
            </div>
            <h3 class="feature-title">ì»¤ë®¤ë‹ˆí‹°</h3>
            <p class="feature-description">
              ë‹¤ë¥¸ ë°˜ë ¤ë™ë¬¼ ê°€ì¡±ë“¤ê³¼ ì†Œí†µí•˜ê³  ì •ë³´ë¥¼ ê³µìœ í•´ë³´ì„¸ìš”.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- í†µê³„ ì„¹ì…˜ -->
    <section class="stats-section">
      <div class="container">
        <div class="stats-grid">
          <div class="stat-item">
            <div class="stat-number">1000+</div>
            <div class="stat-label">í™œì„± ì‚¬ìš©ì</div>
          </div>
          <div class="stat-item">
            <div class="stat-number">5000+</div>
            <div class="stat-label">ë“±ë¡ëœ ë°˜ë ¤ë™ë¬¼</div>
          </div>
          <div class="stat-item">
            <div class="stat-number">10000+</div>
            <div class="stat-label">ê³µìœ ëœ ë‹¤ì´ì–´ë¦¬</div>
          </div>
          <div class="stat-item">
            <div class="stat-number">500+</div>
            <div class="stat-label">ê±°ë˜ëœ ìƒí’ˆ</div>
          </div>
        </div>
      </div>
    </section>

    </template>

    <!-- ë¡œê·¸ì¸í•œ ê²½ìš°: ê²€ìƒ‰ ì»´í¬ë„ŒíŠ¸ì™€ ì „ì²´ ì¼ê¸° ëª©ë¡ -->
    <template v-else>
      <div class="home-content-wrapper">
        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <div class="home-main-content">
          <!-- ê²€ìƒ‰ ì„¹ì…˜ -->
          <div class="home-search-section">
            <div class="search-wrapper">
              <div class="search-and-write-container">
                <SearchComponent
                  v-model="searchKeyword"
                  :search-type="searchType"
                  @update:search-type="searchType = $event"
                  @search="handleSearch"
                  @clear="handleClearSearch"
                />
              </div>
            </div>
          </div>
          
          <AllPostsView />
        </div>

        <!-- ì˜¤ë¥¸ìª½ ì‚¬ì´ë“œë°” -->
        <div class="home-sidebar">
          <!-- ì¸ê¸° í•´ì‹œíƒœê·¸ ì„¹ì…˜ -->
          <v-card class="sidebar-card">
            <div class="insight-header">
              <div class="insight-title">ì¸ê¸° í•´ì‹œíƒœê·¸</div>
            </div>
            <div class="hashtag-list">
              <div 
                class="hashtag-item" 
                v-for="tag in popularHashtags" 
                :key="tag.tagId"
                @click="handleHashtagClick(tag)"
                style="cursor: pointer;"
              >
                <span class="hashtag-text">#{{ tag.name }}</span>
                <span class="hashtag-count">{{ tag.count }}íšŒ</span>
              </div>
            </div>
          </v-card>

          <!-- ì˜¤ëŠ˜ì˜ ë‚ ì”¨ ì„¹ì…˜ -->
          <v-card class="sidebar-card">
            <div class="insight-header">
              <v-icon color="#60A5FA" size="24">mdi-weather-sunny</v-icon>
              <div class="insight-title">ì˜¤ëŠ˜ì˜ ë‚ ì”¨</div>
            </div>
            <div v-if="weatherLoading" class="weather-loading">
              <v-progress-circular indeterminate color="#60A5FA" size="24"></v-progress-circular>
              <span>ë‚ ì”¨ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘...</span>
            </div>
            <div v-else-if="weatherError" class="weather-error">
              <v-icon color="#EF4444" size="24">mdi-alert-circle</v-icon>
              <span>ìœ„ì¹˜ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤</span>
              <v-btn
                size="small"
                variant="outlined"
                color="#60A5FA"
                @click="fetchWeather"
                class="mt-2"
              >
                ìœ„ì¹˜ ê¶Œí•œ ë‹¤ì‹œ ìš”ì²­
              </v-btn>
            </div>
            <div v-else class="weather-detail">
              <div class="weather-location">
                <v-icon size="16" color="#64748B">mdi-map-marker</v-icon>
                <span class="location-text">{{ weatherData.location }}</span>
              </div>
              <div class="weather-main-info">
                <div class="weather-temp-large">{{ Math.round(weatherData.temp) }}Â°C</div>
                <div class="weather-desc">{{ weatherData.description }}</div>
              </div>
              <div class="weather-details">
                <div class="weather-detail-item">
                  <span class="detail-label">ìŠµë„</span>
                  <span class="detail-value">{{ weatherData.humidity }}%</span>
                </div>
                <div class="weather-detail-item">
                  <span class="detail-label">ë°”ëŒ</span>
                  <span class="detail-value">{{ weatherData.windSpeed }}m/s</span>
                </div>
                <div class="weather-detail-item">
                  <span class="detail-label">ì²´ê°ì˜¨ë„</span>
                  <span class="detail-value">{{ Math.round(weatherData.feelsLike) }}Â°C</span>
                </div>
              </div>
            </div>
          </v-card>
        </div>
      </div>
    </template>
  </div>
</template>

<script>
import { computed, inject, onMounted, watch, ref } from 'vue'
import { useAuthStore } from '@/stores/auth'
import { useRoute, useRouter } from 'vue-router'
import AllPostsView from '@/views/diary/AllDiaryView.vue'
import SearchComponent from '@/components/SearchComponent.vue'
import { postAPI } from '@/services/api'

export default {
  name: 'HomeView',
  components: {
    AllPostsView,
    SearchComponent
  },
  setup() {
    const authStore = useAuthStore()
    const route = useRoute()
    const router = useRouter()
    
    // App.vueì—ì„œ ì œê³µí•˜ëŠ” í•¨ìˆ˜ inject
    const openAuthModal = inject('openAuthModal')
    
        const isLoggedIn = computed(() => authStore.isAuthenticated)
    
    // ê²€ìƒ‰ ê´€ë ¨ ìƒíƒœ
    const searchKeyword = ref('')
    const searchType = ref('CONTENT')

    const handleSearch = (searchData) => {
      searchType.value = searchData.searchType
      searchKeyword.value = searchData.keyword
      // ê²€ìƒ‰ ì‹œ ìƒˆë¡œìš´ ê²€ìƒ‰ í˜ì´ì§€ë¡œ ì´ë™
      router.push({
        path: '/search',
        query: {
          searchType: searchData.searchType,
          keyword: searchData.keyword
        }
      })
    }

    const handleClearSearch = () => {
      searchKeyword.value = ''
    }

    // ì¸ê¸° í•´ì‹œíƒœê·¸ ë°ì´í„°
    const popularHashtags = ref([
      { tagId: 1, name: 'ê°•ì•„ì§€', count: 156 },
      { tagId: 2, name: 'ì‚°ì±…', count: 89 },
      { tagId: 3, name: 'ê³ ì–‘ì´', count: 67 },
      { tagId: 4, name: 'ì¥ë‚œê°', count: 45 },
      { tagId: 5, name: 'ëª©ìš•', count: 34 }
    ])

    // ë‚ ì”¨ ê´€ë ¨ ìƒíƒœ
    const weatherData = ref({
      temp: 0,
      feelsLike: 0,
      humidity: 0,
      windSpeed: 0,
      description: '',
      location: ''
    })
    const weatherLoading = ref(true)
    const weatherError = ref(false)

    // ì£¼ì†Œ íŒŒì‹± í•¨ìˆ˜ (ë™, ë©´, ì, ë¦¬ê¹Œì§€ë§Œ í‘œì‹œ)
    const parseAddress = (fullAddress) => {
      if (!fullAddress) return ''
      
      console.log('ğŸ” ì£¼ì†Œ íŒŒì‹± ì‹œì‘:', fullAddress)
      
      // ì¹´ì¹´ì˜¤ë§µ API ì£¼ì†Œ í˜•ì‹: "ì„œìš¸ ë™ì‘êµ¬ ì‹ ëŒ€ë°©ë™ 123-45" -> "ë™ì‘êµ¬ ì‹ ëŒ€ë°©ë™"
      const kakaoPattern = /^[ê°€-í£]+(?:íŠ¹ë³„ì‹œ|ê´‘ì—­ì‹œ|ë„)\s+([ê°€-í£]+(?:ì‹œ|êµ°|êµ¬)\s+[ê°€-í£]+(?:ë™|ë©´|ì|ë¦¬))/
      const kakaoMatch = fullAddress.match(kakaoPattern)
      
      if (kakaoMatch) {
        const result = kakaoMatch[1].trim()
        console.log('ğŸ” ì¹´ì¹´ì˜¤ë§µ íŒ¨í„´ ë§¤ì¹˜ ì„±ê³µ:', result)
        return result
      }
      
      // ê¸°ì¡´ íŒ¨í„´ë“¤ (ë°±ì—…ìš©)
      const patterns = [
        // ì„œìš¸íŠ¹ë³„ì‹œ ë™ì‘êµ¬ ì‹ ëŒ€ë°©ë™ -> ë™ì‘êµ¬ ì‹ ëŒ€ë°©ë™
        /ì„œìš¸íŠ¹ë³„ì‹œ\s+([ê°€-í£]+êµ¬\s+[ê°€-í£]+ë™)/,
        // ì„œìš¸ ë™ì‘êµ¬ ì‹ ëŒ€ë°©ë™ -> ë™ì‘êµ¬ ì‹ ëŒ€ë°©ë™
        /ì„œìš¸\s+([ê°€-í£]+êµ¬\s+[ê°€-í£]+ë™)/,
        // ê²½ê¸°ë„ ê³ ì–‘ì‹œ ì¼ì‚°ì„œêµ¬ ëŒ€í™”ë™ -> ì¼ì‚°ì„œêµ¬ ëŒ€í™”ë™
        /ê²½ê¸°ë„\s+[ê°€-í£]+ì‹œ\s+([ê°€-í£]+êµ¬\s+[ê°€-í£]+ë™)/,
        // ê²½ê¸°ë„ ê³ ì–‘ì‹œ -> ê³ ì–‘ì‹œ
        /ê²½ê¸°ë„\s+([ê°€-í£]+ì‹œ)/,
        // ì¶©ì²­ë‚¨ë„ ë¶€ì—¬êµ° ë¶€ì—¬ì -> ë¶€ì—¬êµ° ë¶€ì—¬ì
        /[ê°€-í£]+ë„\s+([ê°€-í£]+êµ°\s+[ê°€-í£]+ì)/,
        // ê¸°íƒ€ ì‹œ ë‹¨ìœ„ (ë™ê¹Œì§€ í¬í•¨)
        /[ê°€-í£]+ì‹œ\s+([ê°€-í£]+êµ¬\s+[ê°€-í£]+ë™)/,
        // ê¸°íƒ€ ë„ ë‹¨ìœ„ (ì, ë©´, ë¦¬ê¹Œì§€ í¬í•¨)
        /[ê°€-í£]+ë„\s+([ê°€-í£]+(?:ì‹œ|êµ°)\s+[ê°€-í£]+(?:ë™|ì|ë©´|ë¦¬))/,
        // ê¸°íƒ€ ê´‘ì—­ì‹œ (ë™ê¹Œì§€ í¬í•¨)
        /[ê°€-í£]+ê´‘ì—­ì‹œ\s+([ê°€-í£]+êµ¬\s+[ê°€-í£]+ë™)/,
        // ì˜ì–´ ì£¼ì†Œ íŒ¨í„´ (Seoul, Gangnam-gu -> ê°•ë‚¨êµ¬)
        /Seoul,\s*([A-Za-z-]+)/,
        // ì˜ì–´ ì£¼ì†Œ íŒ¨í„´ (Gangnam-gu, Seoul -> ê°•ë‚¨êµ¬)
        /([A-Za-z-]+),\s*Seoul/
      ]
      
      for (const pattern of patterns) {
        const match = fullAddress.match(pattern)
        if (match) {
          const result = match[1].trim()
          console.log('ğŸ” íŒ¨í„´ ë§¤ì¹˜ ì„±ê³µ:', result)
          return result
        }
      }
      
      // íŒ¨í„´ì— ë§ì§€ ì•Šìœ¼ë©´ ì›ë³¸ì—ì„œ ë™, ë©´, ì, ë¦¬ê¹Œì§€ë§Œ ì¶”ì¶œ
      const fallbackPattern = /([ê°€-í£]+(?:ì‹œ|êµ°|êµ¬)\s+[ê°€-í£]+(?:ë™|ë©´|ì|ë¦¬))/
      const fallbackMatch = fullAddress.match(fallbackPattern)
      
      if (fallbackMatch) {
        const result = fallbackMatch[1].trim()
        console.log('ğŸ” í´ë°± íŒ¨í„´ ë§¤ì¹˜ ì„±ê³µ:', result)
        return result
      }
      
      // ìµœì¢… í´ë°±: ì›ë³¸ ë°˜í™˜ (ìµœëŒ€ 15ì)
      const result = fullAddress.length > 15 ? fullAddress.substring(0, 15) + '...' : fullAddress
      console.log('ğŸ” ëª¨ë“  íŒ¨í„´ ë§¤ì¹˜ ì‹¤íŒ¨, ì›ë³¸ ì‚¬ìš©:', result)
      return result
    }

    // ìœ„ì¹˜ ì •ë³´ ìƒíƒœ
    const currentCoords = ref(null)
    const locationError = ref(null)
    
    // ì¹´ì¹´ì˜¤ë§µ APIë¡œ ìœ„ì¹˜ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
    const getKakaoAddress = async (latitude, longitude) => {
      try {
        console.log('ğŸ—ºï¸ ì¹´ì¹´ì˜¤ë§µ API í˜¸ì¶œ:', { latitude, longitude })
        
        const kakaoApiKey = process.env.VUE_APP_KAKAO_MAP_API_KEY
        console.log('ğŸ—ºï¸ ì¹´ì¹´ì˜¤ë§µ API í‚¤:', kakaoApiKey ? 'ì„¤ì •ë¨' : 'ì—†ìŒ')
        
        const response = await fetch(
          `https://dapi.kakao.com/v2/local/geo/coord2address.json?x=${longitude}&y=${latitude}`,
          {
            headers: {
              'Authorization': `KakaoAK ${kakaoApiKey}`
            }
          }
        )
        
        console.log('ğŸ—ºï¸ ì¹´ì¹´ì˜¤ë§µ API ì‘ë‹µ ìƒíƒœ:', response.status)
        
        if (response.ok) {
          const data = await response.json()
          console.log('ğŸ—ºï¸ ì¹´ì¹´ì˜¤ë§µ API ì‘ë‹µ ë°ì´í„°:', data)
          
          if (data.documents && data.documents.length > 0) {
            const address = data.documents[0].address
            console.log('ğŸ—ºï¸ ì¹´ì¹´ì˜¤ë§µ ì£¼ì†Œ ê°ì²´:', address)
            
            // ê°€ì¥ êµ¬ì²´ì ì¸ ì£¼ì†Œ ì •ë³´ ì‚¬ìš©
            const fullAddress = address.address_name
            console.log('ğŸ—ºï¸ ì¹´ì¹´ì˜¤ë§µ ì „ì²´ ì£¼ì†Œ:', fullAddress)
            
            const parsedAddress = parseAddress(fullAddress)
            console.log('ğŸ“ íŒŒì‹±ëœ ì£¼ì†Œ:', parsedAddress)
            return parsedAddress
          } else {
            console.log('ğŸ—ºï¸ ì¹´ì¹´ì˜¤ë§µ API ì‘ë‹µì´ ë¹„ì–´ìˆìŒ')
          }
        } else {
          console.log('ğŸ—ºï¸ ì¹´ì¹´ì˜¤ë§µ API ì‹¤íŒ¨:', response.status, response.statusText)
        }
        
        return null
      } catch (error) {
        console.error('ğŸ—ºï¸ ì¹´ì¹´ì˜¤ë§µ API ì—ëŸ¬:', error)
        return null
      }
    }

    // ìœ„ì¹˜ ì •ë³´ ê°€ì ¸ì˜¤ê¸° (ì¹´ì¹´ì˜¤ë§µ ìš°ì„ , ì‹¤íŒ¨ ì‹œ OpenWeatherMap)
    const getLocationFromCoords = async (latitude, longitude) => {
      try {
        console.log('ğŸŒ ì¢Œí‘œë¡œ ìœ„ì¹˜ ì •ë³´ ê°€ì ¸ì˜¤ê¸°:', { latitude, longitude })
        
        // 1. ì¹´ì¹´ì˜¤ë§µ API ì‹œë„ (ìš°ì„ )
        const kakaoAddress = await getKakaoAddress(latitude, longitude)
        if (kakaoAddress) {
          console.log('âœ… ì¹´ì¹´ì˜¤ë§µ API ì„±ê³µ:', kakaoAddress)
          return kakaoAddress
        }
        
        console.log('âŒ ì¹´ì¹´ì˜¤ë§µ API ì‹¤íŒ¨, OpenWeatherMap ì‹œë„...')
        
        // 2. OpenWeatherMap API ì‹œë„ (ë°±ì—…)
        const apiKey = process.env.VUE_APP_OPENWEATHER_API_KEY || 'demo'
        console.log('ğŸ”‘ OpenWeatherMap API í‚¤ í™•ì¸:', apiKey === 'demo' ? 'ë°ëª¨ í‚¤ ì‚¬ìš©' : 'ì‹¤ì œ í‚¤ ì‚¬ìš©')
        
        const response = await fetch(
          `https://api.openweathermap.org/geo/1.0/reverse?lat=${latitude}&lon=${longitude}&limit=5&appid=${apiKey}`
        )
        
        console.log('ğŸŒ OpenWeatherMap API ì‘ë‹µ ìƒíƒœ:', response.status)
        
        if (response.ok) {
          const data = await response.json()
          console.log('ğŸŒ OpenWeatherMap API ì‘ë‹µ ë°ì´í„°:', data)
          
          if (data && data.length > 0) {
            // ê°€ì¥ ì •í™•í•œ í•œêµ­ ì£¼ì†Œ ì°¾ê¸°
            let bestAddress = null
            
            for (const location of data) {
              console.log('ğŸŒ ê²€í†  ì¤‘ì¸ ìœ„ì¹˜:', location)
              
              // í•œêµ­ì–´ ì£¼ì†Œê°€ ìˆìœ¼ë©´ ìš°ì„  ì‚¬ìš©
              if (location.local_names?.ko) {
                bestAddress = location.local_names.ko
                console.log('ğŸŒ í•œêµ­ì–´ ì£¼ì†Œ ë°œê²¬:', bestAddress)
                break
              }
              
              // ì˜ì–´ ì£¼ì†Œ ì¤‘ì—ì„œ í•œêµ­ ì£¼ì†Œ íŒ¨í„´ ì°¾ê¸°
              if (location.name && location.country === 'KR') {
                bestAddress = location.name
                console.log('ğŸŒ í•œêµ­ ì˜ì–´ ì£¼ì†Œ ë°œê²¬:', bestAddress)
                break
              }
              
              // state ì •ë³´ê°€ ìˆìœ¼ë©´ ë” êµ¬ì²´ì 
              if (location.state && location.country === 'KR') {
                bestAddress = `${location.state}, ${location.name}`
                console.log('ğŸŒ í•œêµ­ state ì£¼ì†Œ ë°œê²¬:', bestAddress)
                break
              }
            }
            
            if (bestAddress) {
              console.log('ğŸŒ ìµœì¢… ì„ íƒëœ ì£¼ì†Œ:', bestAddress)
              const parsedAddress = parseAddress(bestAddress)
              console.log('ğŸ“ íŒŒì‹±ëœ ì£¼ì†Œ:', parsedAddress)
              return parsedAddress
            } else {
              console.log('ğŸŒ ì ì ˆí•œ í•œêµ­ ì£¼ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ')
            }
          } else {
            console.log('ğŸŒ OpenWeatherMap API ì‘ë‹µì´ ë¹„ì–´ìˆìŒ')
          }
        } else {
          console.log('ğŸŒ OpenWeatherMap API ì‹¤íŒ¨:', response.status, response.statusText)
        }
        
        // 3. ëª¨ë“  API ì‹¤íŒ¨ ì‹œ ì¶”ì • ìœ„ì¹˜ ì‚¬ìš©
        console.log('ğŸŒ ëª¨ë“  API ì‹¤íŒ¨, ì¶”ì • ìœ„ì¹˜ ì‚¬ìš©')
        const estimatedLocation = estimateLocationFromCoords(latitude, longitude)
        console.log('ğŸ“ ì¶”ì • ìœ„ì¹˜:', estimatedLocation)
        return estimatedLocation
        
      } catch (error) {
        console.error('ğŸŒ ìœ„ì¹˜ ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error)
        // ì—ëŸ¬ ì‹œ ì¶”ì • ìœ„ì¹˜ ì‚¬ìš©
        const estimatedLocation = estimateLocationFromCoords(latitude, longitude)
        console.log('ğŸ“ ì—ëŸ¬ë¡œ ì¸í•œ ì¶”ì • ìœ„ì¹˜:', estimatedLocation)
        return estimatedLocation
      }
    }

    // ì¢Œí‘œë¡œ ëŒ€ëµì ì¸ ìœ„ì¹˜ ì¶”ì • (API í‚¤ê°€ ì—†ì„ ë•Œ)
    const estimateLocationFromCoords = (latitude, longitude) => {
      console.log('ğŸ—ºï¸ ìœ„ì¹˜ ì¶”ì • ì‹œì‘:', { latitude, longitude })
      
      // ë” ì„¸ë°€í•œ ì§€ì—­ ì •ë³´ë¥¼ í¬í•¨í•œ ì¢Œí‘œ ë°ì´í„°
      const locations = [
        // ì„œìš¸ ì§€ì—­
        { name: 'ê°•ë‚¨êµ¬', lat: 37.5172, lon: 127.0473 },
        { name: 'ì„œì´ˆêµ¬', lat: 37.4837, lon: 127.0324 },
        { name: 'ë§ˆí¬êµ¬', lat: 37.5637, lon: 126.9085 },
        { name: 'ì¢…ë¡œêµ¬', lat: 37.5735, lon: 126.9788 },
        { name: 'ì¤‘êµ¬', lat: 37.5640, lon: 126.9979 },
        { name: 'ìš©ì‚°êµ¬', lat: 37.5384, lon: 126.9654 },
        { name: 'ì„±ë™êµ¬', lat: 37.5506, lon: 127.0409 },
        { name: 'ê´‘ì§„êµ¬', lat: 37.5384, lon: 127.0822 },
        { name: 'ë™ëŒ€ë¬¸êµ¬', lat: 37.5744, lon: 127.0395 },
        { name: 'ì¤‘ë‘êµ¬', lat: 37.6064, lon: 127.0926 },
        { name: 'ì„±ë¶êµ¬', lat: 37.5894, lon: 127.0167 },
        { name: 'ê°•ë¶êµ¬', lat: 37.6396, lon: 127.0257 },
        { name: 'ë„ë´‰êµ¬', lat: 37.6688, lon: 127.0471 },
        { name: 'ë…¸ì›êµ¬', lat: 37.6542, lon: 127.0568 },
        { name: 'ì€í‰êµ¬', lat: 37.6027, lon: 126.9291 },
        { name: 'ì„œëŒ€ë¬¸êµ¬', lat: 37.5791, lon: 126.9368 },
        { name: 'ì˜ë“±í¬êµ¬', lat: 37.5264, lon: 126.8962 },
        { name: 'ë™ì‘êµ¬', lat: 37.5124, lon: 126.9393 },
        { name: 'ê´€ì•…êµ¬', lat: 37.4784, lon: 126.9516 },
        { name: 'ê¸ˆì²œêµ¬', lat: 37.4569, lon: 126.8956 },
        { name: 'ê°•ì„œêµ¬', lat: 37.5509, lon: 126.8495 },
        { name: 'ì–‘ì²œêµ¬', lat: 37.5270, lon: 126.8565 },
        { name: 'êµ¬ë¡œêµ¬', lat: 37.4954, lon: 126.8874 },
        { name: 'ì†¡íŒŒêµ¬', lat: 37.5145, lon: 127.1059 },
        { name: 'ê°•ë™êµ¬', lat: 37.5301, lon: 127.1238 },
        
        // ê²½ê¸°ë„ ì£¼ìš” ì§€ì—­
        { name: 'ìˆ˜ì›ì‹œ', lat: 37.2636, lon: 127.0286 },
        { name: 'ê³ ì–‘ì‹œ', lat: 37.6584, lon: 126.8320 },
        { name: 'ìš©ì¸ì‹œ', lat: 37.2411, lon: 127.1776 },
        { name: 'ì„±ë‚¨ì‹œ', lat: 37.4449, lon: 127.1389 },
        { name: 'ë¶€ì²œì‹œ', lat: 37.5035, lon: 126.7660 },
        { name: 'ì•ˆì‚°ì‹œ', lat: 37.3219, lon: 126.8309 },
        { name: 'ì•ˆì–‘ì‹œ', lat: 37.3943, lon: 126.9568 },
        { name: 'í‰íƒì‹œ', lat: 36.9920, lon: 127.1128 },
        { name: 'ì‹œí¥ì‹œ', lat: 37.3799, lon: 126.8031 },
        { name: 'ê¹€í¬ì‹œ', lat: 37.6156, lon: 126.7158 },
        { name: 'ê´‘ì£¼ì‹œ', lat: 37.4295, lon: 127.2551 },
        { name: 'ê´‘ëª…ì‹œ', lat: 37.4794, lon: 126.8649 },
        { name: 'êµ°í¬ì‹œ', lat: 37.3616, lon: 126.9352 },
        { name: 'ì˜¤ì‚°ì‹œ', lat: 37.1498, lon: 127.0772 },
        { name: 'í•˜ë‚¨ì‹œ', lat: 37.5392, lon: 127.2148 },
        { name: 'ì´ì²œì‹œ', lat: 37.2720, lon: 127.4350 },
        { name: 'ì•ˆì„±ì‹œ', lat: 37.0080, lon: 127.2797 },
        { name: 'ì˜ì™•ì‹œ', lat: 37.3449, lon: 126.9482 },
        { name: 'ì–‘í‰êµ°', lat: 37.4912, lon: 127.4875 },
        { name: 'ì—¬ì£¼ì‹œ', lat: 37.2984, lon: 127.6370 },
        { name: 'ê³¼ì²œì‹œ', lat: 37.4291, lon: 126.9879 },
        { name: 'ë‚¨ì–‘ì£¼ì‹œ', lat: 37.6364, lon: 127.2160 },
        { name: 'íŒŒì£¼ì‹œ', lat: 37.8154, lon: 126.7928 },
        { name: 'ì˜ì •ë¶€ì‹œ', lat: 37.7381, lon: 127.0337 },
        { name: 'ì–‘ì£¼ì‹œ', lat: 37.8323, lon: 127.0462 },
        { name: 'êµ¬ë¦¬ì‹œ', lat: 37.5943, lon: 127.1296 },
        { name: 'í¬ì²œì‹œ', lat: 37.8949, lon: 127.2002 },
        { name: 'ë™ë‘ì²œì‹œ', lat: 37.9036, lon: 127.0606 },
        { name: 'ê°€í‰êµ°', lat: 37.8315, lon: 127.5105 },
        { name: 'ì—°ì²œêµ°', lat: 38.0966, lon: 127.0747 },
        
        // ê¸°íƒ€ ì£¼ìš” ë„ì‹œ
        { name: 'ë¶€ì‚°', lat: 35.1796, lon: 129.0756 },
        { name: 'ëŒ€êµ¬', lat: 35.8714, lon: 128.6014 },
        { name: 'ì¸ì²œ', lat: 37.4563, lon: 126.7052 },
        { name: 'ê´‘ì£¼', lat: 35.1595, lon: 126.8526 },
        { name: 'ëŒ€ì „', lat: 36.3504, lon: 127.3845 },
        { name: 'ìš¸ì‚°', lat: 35.5384, lon: 129.3114 },
        { name: 'ì„¸ì¢…', lat: 36.4800, lon: 127.2890 },
        { name: 'ì°½ì›', lat: 35.2278, lon: 128.6817 },
        { name: 'í¬í•­', lat: 36.0320, lon: 129.3650 },
        { name: 'ì²­ì£¼', lat: 36.6424, lon: 127.4890 },
        { name: 'ì „ì£¼', lat: 35.8242, lon: 127.1480 },
        { name: 'ì²œì•ˆ', lat: 36.8151, lon: 127.1139 },
        { name: 'ê¹€í•´', lat: 35.2281, lon: 128.8891 }
      ]
      
              // ê°€ì¥ ê°€ê¹Œìš´ ì§€ì—­ ì°¾ê¸°
        let closestLocation = locations[0]
        let minDistance = Number.MAX_VALUE
        
        for (const location of locations) {
          const distance = Math.sqrt(
            Math.pow(latitude - location.lat, 2) + Math.pow(longitude - location.lon, 2)
          )
          if (distance < minDistance) {
            minDistance = distance
            closestLocation = location
          }
        }
        
        // ê±°ë¦¬ê°€ ë§¤ìš° ê°€ê¹Œìš°ë©´ (0.01 ì´í•˜) ë” êµ¬ì²´ì ì¸ ë™ë„¤ ì •ë³´ ì¶”ê°€
        let result = closestLocation.name
        if (minDistance < 0.01) {
          // ë™ì‘êµ¬ ê·¼ì²˜ë¼ë©´ êµ¬ì²´ì ì¸ ë™ë„¤ ì¶”ê°€
          if (closestLocation.name === 'ë™ì‘êµ¬') {
            result = 'ë™ì‘êµ¬ ì‹ ëŒ€ë°©ë™'
          } else if (closestLocation.name === 'ê°•ë‚¨êµ¬') {
            result = 'ê°•ë‚¨êµ¬ ì—­ì‚¼ë™'
          } else if (closestLocation.name === 'ì„œì´ˆêµ¬') {
            result = 'ì„œì´ˆêµ¬ ì„œì´ˆë™'
          } else if (closestLocation.name === 'ë§ˆí¬êµ¬') {
            result = 'ë§ˆí¬êµ¬ í•©ì •ë™'
          }
        }
        
        console.log('ğŸ—ºï¸ ì¶”ì •ëœ ìœ„ì¹˜:', result, 'ê±°ë¦¬:', minDistance.toFixed(4))
        return result
    }

    // ìœ„ì¹˜ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
    const getCurrentLocation = () => {
      return new Promise((resolve, reject) => {
        if (!navigator.geolocation) {
          reject(new Error('ìœ„ì¹˜ ì •ë³´ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤'))
          return
        }
        
        console.log('ğŸ“ ìœ„ì¹˜ ì •ë³´ ìš”ì²­ ì‹œì‘...')
        
        navigator.geolocation.getCurrentPosition(
          (position) => {
            const coords = {
              latitude: position.coords.latitude,
              longitude: position.coords.longitude
            }
            console.log('âœ… ìœ„ì¹˜ ì •ë³´ ì„±ê³µ:', coords)
            currentCoords.value = coords
            locationError.value = null
            resolve(coords)
          },
          (error) => {
            console.error('âŒ ìœ„ì¹˜ ì •ë³´ ì—ëŸ¬:', error)
            locationError.value = error
            
            // ì—ëŸ¬ ì½”ë“œë³„ ìƒì„¸ ë©”ì‹œì§€
            switch (error.code) {
              case 1:
                console.error('ìœ„ì¹˜ ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤')
                break
              case 2:
                console.error('ìœ„ì¹˜ ì •ë³´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤')
                break
              case 3:
                console.error('ìœ„ì¹˜ ì •ë³´ ìš”ì²­ ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤')
                break
              default:
                console.error('ì•Œ ìˆ˜ ì—†ëŠ” ìœ„ì¹˜ ì—ëŸ¬:', error.message)
            }
            
            reject(error)
          },
          {
            timeout: 30000, // 30ì´ˆë¡œ ì¦ê°€
            enableHighAccuracy: true, // ì •í™•ë„ í–¥ìƒ
            maximumAge: 60000 // 1ë¶„ìœ¼ë¡œ ë‹¨ì¶•
          }
        )
      })
    }

    // ì¸ê¸° í•´ì‹œíƒœê·¸ ê°€ì ¸ì˜¤ê¸°
const fetchPopularHashtags = async () => {
  try {
    console.log('ğŸ·ï¸ ì¸ê¸° í•´ì‹œíƒœê·¸ ê°€ì ¸ì˜¤ê¸° ì‹œì‘...');
    console.log('ğŸ·ï¸ API ì—”ë“œí¬ì¸íŠ¸: /posts/rank-hashtag');
    console.log('ğŸ·ï¸ í˜„ì¬ popularHashtags ì´ˆê¸°ê°’:', popularHashtags.value);
    
    const response = await postAPI.getRankHashtags();
    console.log('ğŸ·ï¸ API ì‘ë‹µ ì „ì²´:', JSON.stringify(response, null, 2));
    console.log('ğŸ·ï¸ API ì‘ë‹µ ë°ì´í„°:', JSON.stringify(response.data, null, 2));
    console.log('ğŸ·ï¸ ì‘ë‹µ ë°ì´í„° íƒ€ì…:', typeof response.data);
    console.log('ğŸ·ï¸ ì‘ë‹µ ë°ì´í„° ê¸¸ì´:', Array.isArray(response.data) ? response.data.length : 'ë°°ì—´ ì•„ë‹˜');
    
    // ì‘ë‹µ êµ¬ì¡°: { isSuccess: true, data: [...], status: {...} }
    const hashtagData = response.data.data;
    console.log('ğŸ·ï¸ ì‹¤ì œ í•´ì‹œíƒœê·¸ ë°ì´í„°:', JSON.stringify(hashtagData, null, 2));
    console.log('ğŸ·ï¸ í•´ì‹œíƒœê·¸ ë°ì´í„° íƒ€ì…:', typeof hashtagData);
    console.log('ğŸ·ï¸ í•´ì‹œíƒœê·¸ ë°ì´í„° ê¸¸ì´:', Array.isArray(hashtagData) ? hashtagData.length : 'ë°°ì—´ ì•„ë‹˜');
    
    if (Array.isArray(hashtagData)) {
      console.log('ğŸ·ï¸ ê° í•´ì‹œíƒœê·¸ ë°ì´í„°:');
      hashtagData.forEach((tag, index) => {
        console.log(`  ${index + 1}.`, JSON.stringify(tag, null, 2));
      });
    }
    
    popularHashtags.value = hashtagData;
    console.log('ğŸ·ï¸ popularHashtags ì—…ë°ì´íŠ¸ ì™„ë£Œ:', JSON.stringify(popularHashtags.value, null, 2));
  } catch (error) {
    console.error('âŒ ì¸ê¸° í•´ì‹œíƒœê·¸ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error);
    console.error('âŒ ì—ëŸ¬ ìƒì„¸ ì •ë³´:', {
      message: error.message,
      status: error.response?.status,
      statusText: error.response?.statusText,
      data: error.response?.data
    });
    
    console.log('ğŸ·ï¸ ê¸°ë³¸ ë°ì´í„°ë¡œ fallback...');
    // ê¸°ë³¸ ë°ì´í„° ì‚¬ìš©
    popularHashtags.value = [
      { tagId: 1, name: 'ê°•ì•„ì§€', count: 156 },
      { tagId: 2, name: 'ì‚°ì±…', count: 89 },
      { tagId: 3, name: 'ê³ ì–‘ì´', count: 67 },
      { tagId: 4, name: 'ì¥ë‚œê°', count: 45 },
      { tagId: 5, name: 'ëª©ìš•', count: 34 }
    ];
    console.log('ğŸ·ï¸ ê¸°ë³¸ ë°ì´í„° ì„¤ì • ì™„ë£Œ:', JSON.stringify(popularHashtags.value, null, 2));
  }
};

// í•´ì‹œíƒœê·¸ í´ë¦­ í•¸ë“¤ëŸ¬
const handleHashtagClick = (hashtag) => {
  console.log('ğŸ·ï¸ í•´ì‹œíƒœê·¸ í´ë¦­ ì‹œì‘...');
  console.log('ğŸ·ï¸ í´ë¦­ëœ í•´ì‹œíƒœê·¸ ë°ì´í„°:', JSON.stringify(hashtag, null, 2));
  console.log('ğŸ·ï¸ í•´ì‹œíƒœê·¸ íƒ€ì…:', typeof hashtag);
  console.log('ğŸ·ï¸ í•´ì‹œíƒœê·¸ ì†ì„±ë“¤:', Object.keys(hashtag));
  
  // ê²€ìƒ‰ì°½ì— í•´ì‹œíƒœê·¸ ì…ë ¥ (í•´ì‹œíƒœê·¸ ê¸°í˜¸ ì—†ì´)
  const searchQuery = hashtag.name;
  console.log('ğŸ·ï¸ ê²€ìƒ‰ ì¿¼ë¦¬ ìƒì„±:', searchQuery);
  
  searchKeyword.value = searchQuery;
  console.log('ğŸ·ï¸ ê²€ìƒ‰ ì¿¼ë¦¬:', searchQuery);
  
  // ê²€ìƒ‰ ì‹¤í–‰ (searchTypeì„ HASHTAGë¡œ ì„¤ì •)
  const routeQuery = { 
    keyword: searchQuery,
    searchType: 'HASHTAG'
  };
  console.log('ğŸ·ï¸ ë¼ìš°í„° ì¿¼ë¦¬:', JSON.stringify(routeQuery, null, 2));
  
  router.push({
    path: '/search',
    query: routeQuery
  });
  console.log('ğŸ·ï¸ ë¼ìš°í„° ì´ë™ ì™„ë£Œ');
};

// ë‚ ì”¨ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
const fetchWeather = async () => {
      try {
        console.log('ğŸŒ¤ï¸ ë‚ ì”¨ ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì‹œì‘...')
        weatherLoading.value = true
        weatherError.value = false
        
        // ìœ„ì¹˜ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        let coords = currentCoords.value
        console.log('ğŸ“ ìºì‹œëœ ìœ„ì¹˜ ì •ë³´:', coords)
        
        if (!coords) {
          console.log('ğŸ“ ìºì‹œëœ ìœ„ì¹˜ ì •ë³´ ì—†ìŒ, ìƒˆë¡œ ìš”ì²­...')
          coords = await getCurrentLocation()
        }
        
        console.log('ğŸ“ ìµœì¢… ìœ„ì¹˜ ì¢Œí‘œ:', coords)
        
        // ìœ„ì¹˜ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        console.log('ğŸŒ ìœ„ì¹˜ ì •ë³´ íŒŒì‹± ì‹œì‘...')
        const location = await getLocationFromCoords(coords.latitude, coords.longitude)
        console.log('ğŸ“ ìµœì¢… íŒŒì‹±ëœ ìœ„ì¹˜:', location)
        
        // OpenWeatherMap API í˜¸ì¶œ
        const apiKey = process.env.VUE_APP_OPENWEATHER_API_KEY || 'demo'
        console.log('ğŸŒ¤ï¸ ë‚ ì”¨ API í‚¤:', apiKey === 'demo' ? 'ë°ëª¨ í‚¤' : 'ì‹¤ì œ í‚¤')
        
        const weatherUrl = `https://api.openweathermap.org/data/2.5/weather?lat=${coords.latitude}&lon=${coords.longitude}&appid=${apiKey}&units=metric&lang=kr`
        console.log('ğŸŒ¤ï¸ ë‚ ì”¨ API URL:', weatherUrl)
        
        const response = await fetch(weatherUrl)
        console.log('ğŸŒ¤ï¸ ë‚ ì”¨ API ì‘ë‹µ ìƒíƒœ:', response.status)
        
        if (!response.ok) {
          console.log('ğŸŒ¤ï¸ ë‚ ì”¨ API ì‹¤íŒ¨, ê¸°ë³¸ ë°ì´í„° ì‚¬ìš©')
          // API í‚¤ê°€ ì—†ê±°ë‚˜ ì—ëŸ¬ì¸ ê²½ìš°ì—ë„ ìœ„ì¹˜ ì •ë³´ëŠ” í‘œì‹œ
          weatherData.value = {
            temp: 23,
            feelsLike: 25,
            humidity: 65,
            windSpeed: 3,
            description: 'ë§‘ìŒ',
            location: location
          }
          console.log('ğŸŒ¤ï¸ ê¸°ë³¸ ë‚ ì”¨ ë°ì´í„° ì„¤ì •:', weatherData.value)
          return
        }
        
        const data = await response.json()
        console.log('ğŸŒ¤ï¸ ë‚ ì”¨ API ì‘ë‹µ ë°ì´í„°:', data)
        
        weatherData.value = {
          temp: data.main.temp,
          feelsLike: data.main.feels_like,
          humidity: data.main.humidity,
          windSpeed: data.wind.speed,
          description: data.weather[0].description,
          location: location
        }
        
        console.log('ğŸŒ¤ï¸ ìµœì¢… ë‚ ì”¨ ë°ì´í„°:', weatherData.value)
        
      } catch (error) {
        console.error('âŒ ë‚ ì”¨ ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error)
        
        // ìœ„ì¹˜ ì—ëŸ¬ ì²˜ë¦¬
        if (locationError.value) {
          weatherError.value = true
          console.log('âŒ ìœ„ì¹˜ ì—ëŸ¬:', locationError.value)
        } else {
          console.log('âŒ ê¸°íƒ€ ì—ëŸ¬, ê¸°ë³¸ ë°ì´í„° ì‚¬ìš©')
          // ê¸°íƒ€ ì—ëŸ¬ì˜ ê²½ìš° ê¸°ë³¸ ë°ì´í„° ì‚¬ìš© (ìœ„ì¹˜ ì •ë³´ëŠ” ì¶”ì •)
          const estimatedLocation = estimateLocationFromCoords(37.5665, 126.9780) // ì„œìš¸ ì¢Œí‘œ
          weatherData.value = {
            temp: 23,
            feelsLike: 25,
            humidity: 65,
            windSpeed: 3,
            description: 'ë§‘ìŒ',
            location: estimatedLocation
          }
          console.log('ğŸŒ¤ï¸ ì—ëŸ¬ë¡œ ì¸í•œ ê¸°ë³¸ ë‚ ì”¨ ë°ì´í„°:', weatherData.value)
        }
      } finally {
        weatherLoading.value = false
        console.log('ğŸŒ¤ï¸ ë‚ ì”¨ ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì™„ë£Œ')
      }
    }



    // OAuth ëª¨ë‹¬ ìë™ ì—´ê¸°
    onMounted(() => {
      console.log('ğŸ  HomeView ë§ˆìš´íŠ¸ ì‹œì‘...')
      
      // ë‚ ì”¨ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
      console.log('ğŸŒ¤ï¸ ë‚ ì”¨ ì •ë³´ ê°€ì ¸ì˜¤ê¸° í˜¸ì¶œ...')
      fetchWeather()
      
      // ì¸ê¸° í•´ì‹œíƒœê·¸ ê°€ì ¸ì˜¤ê¸°
      console.log('ğŸ·ï¸ ì¸ê¸° í•´ì‹œíƒœê·¸ ê°€ì ¸ì˜¤ê¸° í˜¸ì¶œ...')
      fetchPopularHashtags()
      
      // ë¡œê·¸ì¸ ëª¨ë‹¬ ìë™ ì—´ê¸° (ë¼ìš°í„° ê°€ë“œì—ì„œ ë¦¬ë‹¤ì´ë ‰íŠ¸ëœ ê²½ìš°)
      // ë¡œê·¸ì¸ ëª¨ë‹¬ ìë™ ì—´ê¸° (ë¼ìš°í„° ê°€ë“œì—ì„œ ë¦¬ë‹¤ì´ë ‰íŠ¸ëœ ê²½ìš°)
      const { showLogin } = route.query
      if (showLogin === 'true') {
        console.log('ğŸ” ë¼ìš°í„° ê°€ë“œì—ì„œ ë¡œê·¸ì¸ ëª¨ë‹¬ ìë™ ì—´ê¸°')
        if (openAuthModal) {
          openAuthModal('login')
        }
        // URLì—ì„œ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì œê±°
        window.history.replaceState({}, document.title, '/')
      }
      
      // OAuth ì¶”ê°€ì •ë³´ ëª¨ë‹¬
      const { openOAuthExtra, provider, signupTicket, email } = route.query
      if (openOAuthExtra === 'true' && provider && signupTicket && email) {
        const openOAuthExtraModal = inject('openOAuthExtraModal')
        if (openOAuthExtraModal) {
          openOAuthExtraModal({
            provider,
            signupTicket,
            email
          })
        }
        // URLì—ì„œ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì œê±°
        window.history.replaceState({}, document.title, '/')
      }
      
      // ì†Œì…œ ì—°ë™ ëª¨ë‹¬
      const { openOAuthLink, provider: linkProvider, email: linkEmail, linkTicket } = route.query
      if (openOAuthLink === 'true' && linkProvider && linkEmail && linkTicket) {
        const openOAuthLinkModal = inject('openOAuthLinkModal')
        if (openOAuthLinkModal) {
          openOAuthLinkModal({
            provider: linkProvider,
            email: linkEmail,
            linkTicket
          })
        }
        // URLì—ì„œ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì œê±°
        window.history.replaceState({}, document.title, '/')
      }
      
      // OAuth ì¶”ê°€ì •ë³´ ëª¨ë‹¬ (ì¤‘ë³µ ì œê±°)
      const { openOAuthExtra: extraFlag, provider: extraProvider, email: extraEmail, signupTicket: extraTicket } = route.query
      if (extraFlag === 'true' && extraProvider && extraEmail && extraTicket) {
        const openOAuthExtraModal = inject('openOAuthExtraModal')
        if (openOAuthExtraModal) {
          openOAuthExtraModal({
            provider: extraProvider,
            email: extraEmail,
            signupTicket: extraTicket
          })
        }
        // URLì—ì„œ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì œê±°
        window.history.replaceState({}, document.title, '/')
      }
      
      // ì†Œì…œ ê³„ì • ì¤‘ë³µ ëª¨ë‹¬
      const { showSocialDuplicate, duplicateEmail, duplicateProvider } = route.query
      if (showSocialDuplicate === 'true' && duplicateEmail && duplicateProvider) {
        const openSocialDuplicateModal = inject('openSocialDuplicateModal')
        if (openSocialDuplicateModal) {
          openSocialDuplicateModal({
            email: duplicateEmail,
            provider: duplicateProvider
          })
        }
        // URLì—ì„œ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì œê±°
        window.history.replaceState({}, document.title, '/')
      }
      
      // ì‚­ì œëœ ê³„ì • ëª¨ë‹¬
      const { showDeletedAccount, deletedEmail } = route.query
      if (showDeletedAccount === 'true' && deletedEmail) {
        const openDeletedAccountModal = inject('openDeletedAccountModal')
        if (openDeletedAccountModal) {
          openDeletedAccountModal({
            email: deletedEmail
          })
        }
        // URLì—ì„œ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì œê±°
        window.history.replaceState({}, document.title, '/')
      }
    })
    
    // ë¡œê·¸ì¸ ìƒíƒœ ë³€í™”ë¥¼ ê°ì§€í•˜ê¸° ìœ„í•´ watch ì¶”ê°€
    watch(() => authStore.isAuthenticated, (newValue) => {
      console.log('ë¡œê·¸ì¸ ìƒíƒœ ë³€í™” ê°ì§€:', newValue)
    }, { immediate: true })
    
    return {
      isLoggedIn,
      openAuthModal,
      searchKeyword,
      searchType,
      handleSearch,
      handleClearSearch,
      popularHashtags,
      handleHashtagClick,
      weatherData,
      weatherLoading,
      weatherError,
      fetchWeather
    }
  }
}
</script>

<style scoped>
/* í™ˆë·° ì „ì²´ ìŠ¤íƒ€ì¼ */
.home-view {
  min-height: 100vh;
}

/* í™ˆ ì½˜í…ì¸  ë˜í¼ */
.home-content-wrapper {
  display: flex;
  gap: 24px;
  max-width: 1920px;
  margin: 0 auto;
  padding: 0 24px;
}

/* ë©”ì¸ ì½˜í…ì¸  */
  .home-main-content {
  flex: 1;
  min-width: 0;
  margin-top: 10px;
  padding-right: 40px;
  padding-left: 0;
  max-width: calc(100% - 400px);
  margin-left: 40px;
  margin-right: auto;
}

/* ì˜¤ë¥¸ìª½ ì‚¬ì´ë“œë°” */
.home-sidebar {
  width: 320px;
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  gap: 16px;
  padding-top: 40px;
  position: fixed;
  top: 10px;
  right: 40px;
  z-index: 999;
  max-height: calc(100vh - 40px);
  overflow-y: auto;
}

/* ì‚¬ì´ë“œë°” ì¹´ë“œ */
.sidebar-card {
  background: #FFFFFF !important;
  border-radius: 16px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  border: 1px solid rgba(0, 0, 0, 0.06);
  padding: 16px;
}

/* ì¸ì‚¬ì´íŠ¸ í—¤ë” */
.insight-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 12px;
}

.insight-title {
  font-size: 1.1rem;
  font-weight: 600;
  color: #1E293B;
}

/* í•´ì‹œíƒœê·¸ ë¦¬ìŠ¤íŠ¸ */
.hashtag-list {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.hashtag-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 6px 10px;
  background: #F8FAFC;
  border-radius: 8px;
  transition: all 0.2s ease;
}

.hashtag-item:hover {
  background: #F1F5F9;
  transform: translateX(2px);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.hashtag-text {
  font-weight: 500;
  color: #475569;
}

.hashtag-count {
  font-size: 0.9rem;
  color: #64748B;
  font-weight: 500;
}

/* ë‚ ì”¨ ìƒì„¸ */
.weather-detail {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* ìœ„ì¹˜ ì •ë³´ */
.weather-location {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 12px;
  background: #F8FAFC;
  border-radius: 8px;
  margin-bottom: 8px;
}

.location-text {
  font-size: 0.9rem;
  color: #475569;
  font-weight: 500;
}

.weather-main-info {
  text-align: center;
  padding: 16px 0;
}

.weather-temp-large {
  font-size: 2.5rem;
  font-weight: 700;
  color: #1E293B;
  line-height: 1;
}

.weather-desc {
  font-size: 1.1rem;
  color: #475569;
  margin-top: 4px;
}

.weather-details {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.weather-detail-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 0;
  border-bottom: 1px solid #E2E8F0;
}

.weather-detail-item:last-child {
  border-bottom: none;
}

.detail-label {
  font-size: 0.9rem;
  color: #64748B;
}

.detail-value {
  font-weight: 600;
  color: #1E293B;
}

/* ë‚ ì”¨ ë¡œë”© ìƒíƒœ */
.weather-loading {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  padding: 20px 0;
  color: #64748B;
  font-size: 0.9rem;
}

/* ë‚ ì”¨ ì—ëŸ¬ ìƒíƒœ */
.weather-error {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  padding: 20px 0;
  color: #EF4444;
  font-size: 0.9rem;
  text-align: center;
}

/* ê²€ìƒ‰ ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
.home-search-section {
  background: transparent;
  padding: 20px 0;
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  margin-left: 10px;
}

.search-wrapper {
  width: 100%;
  max-width: 800px;
  padding: 0 20px;
  display: flex;
  justify-content: center;
  margin: 0 auto;
}

.search-and-write-container {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.search-and-write-container :deep(.search-component) {
  width: 100%;
  max-width: 700px;
}

.search-and-write-container :deep(.search-component .v-text-field) {
  width: 100%;
  min-width: 600px;
}

.search-and-write-container :deep(.search-component .v-text-field__field) {
  width: 100%;
}

.search-and-write-container :deep(.search-component .v-text-field__input) {
  width: 100%;
  min-width: 500px;
}



/* íˆì–´ë¡œ ì„¹ì…˜ */
.hero-section {
  position: relative;
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

.hero-background {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, #FAF8F5 0%, #FFFFFF 100%);
  z-index: -2;
}

.hero-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(255, 255, 255, 0.0);
  z-index: -1;
}

.floating-shapes {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: -1;
}

.shape {
  position: absolute;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.1);
  animation: float 6s ease-in-out infinite;
}

.shape-1 {
  width: 100px;
  height: 100px;
  top: 20%;
  left: 10%;
  animation-delay: 0s;
}

.shape-2 {
  width: 150px;
  height: 150px;
  top: 60%;
  right: 20%;
  animation-delay: 2s;
}

.shape-3 {
  width: 80px;
  height: 80px;
  bottom: 20%;
  left: 20%;
  animation-delay: 4s;
}

@keyframes float {
  0%, 100% { transform: translateY(0px) rotate(0deg); }
  50% { transform: translateY(-20px) rotate(180deg); }
}

.hero-content {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 64px;
  align-items: center;
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 32px;
  z-index: 1;
}

.hero-text {
  color: #111111;
  text-align: left;
}

.hero-title {
  font-size: 3.5rem;
  font-weight: 800;
  line-height: 1.2;
  margin-bottom: 24px;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.06);
}

.title-line {
  display: block;
}

.hero-subtitle {
  font-size: 1.25rem;
  line-height: 1.6;
  margin-bottom: 48px;
  opacity: 0.95;
  color: #4B5563;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.04);
}

.hero-actions {
  display: flex;
  gap: 16px;
  flex-wrap: wrap;
}

.hero-btn {
  border-radius: 16px;
  font-weight: 600;
  padding: 16px 32px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  line-height: 1;
  text-transform: none;
}

.hero-btn:hover {
  transform: translateY(-4px);
  box-shadow: 0 16px 40px rgba(0, 0, 0, 0.25);
}

.login-btn {
  background: linear-gradient(135deg, #FF8B8B 0%, #FF6B6B 100%) !important;
  color: #fff !important;
}

.register-btn {
  border: 2px solid #FF8B8B;
  color: #FF8B8B !important;
  background: transparent !important;
}

.register-btn:hover {
  background: #FF8B8B !important;
  color: #ffffff !important;
}

.dashboard-btn {
  background: linear-gradient(135deg, #FF8B8B 0%, #FF6B6B 100%) !important;
}

/* íˆì–´ë¡œ ë¹„ì£¼ì–¼ */
.hero-visual {
  display: flex;
  justify-content: center;
  align-items: center;
}

.pet-illustrations {
  position: relative;
  width: 300px;
  height: 300px;
}

.pet {
  position: absolute;
  font-size: 80px;
  filter: drop-shadow(0 8px 16px rgba(0, 0, 0, 0.3));
  animation: bounce 3s ease-in-out infinite;
}

.pet-dog {
  top: 0;
  left: 50%;
  transform: translateX(-50%);
  animation-delay: 0s;
}

.pet-cat {
  bottom: 0;
  left: 20%;
  animation-delay: 1s;
}

.pet-bird {
  bottom: 0;
  right: 20%;
  animation-delay: 2s;
}

@keyframes bounce {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

/* ê¸°ëŠ¥ ì†Œê°œ ì„¹ì…˜ */
.features-section {
  padding: 120px 0;
  background: linear-gradient(135deg, #FF8B8B 0%, #FFC1C1 100%);
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 32px;
}

.section-title {
  text-align: center;
  font-size: 2.5rem;
  font-weight: 700;
  color: #FFFFFF !important;
  margin-bottom: 64px;
}

.features-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 32px;
}

.feature-card {
  background: #FFFFFF;
  padding: 40px 32px;
  border-radius: 24px;
  text-align: center;
  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.06);
  border: 1px solid rgba(0, 0, 0, 0.06);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

/* íŒ”ë ˆíŠ¸ ë³€í˜•: ì¹´ë“œë³„ ë°°ê²½/ì•„ì´ì½˜/í…ìŠ¤íŠ¸ ì»¬ëŸ¬ ì°¨ë³„í™” */
.palette-pet { background: linear-gradient(135deg, #FFF5F5 0%, #FFECEC 100%); }
.palette-pet .feature-icon { background: linear-gradient(135deg, #FFE3E3 0%, #FFD6D6 100%); }
.palette-pet .feature-title { color: #7F1D1D; }

.palette-diary { background: linear-gradient(135deg, #F5FFF7 0%, #ECFFEE 100%); }
.palette-diary .feature-icon { background: linear-gradient(135deg, #DFFBE5 0%, #CCF7D5 100%); }
.palette-diary .feature-title { color: #065F46; }

.palette-market { background: linear-gradient(135deg, #F5F8FF 0%, #ECF2FF 100%); }
.palette-market .feature-icon { background: linear-gradient(135deg, #DDE7FF 0%, #CCD9FF 100%); }
.palette-market .feature-title { color: #1E3A8A; }

.palette-community { background: linear-gradient(135deg, #FFF9F0 0%, #FFF2E0 100%); }
.palette-community .feature-icon { background: linear-gradient(135deg, #FFE6C7 0%, #FFD8A8 100%); }
.palette-community .feature-title { color: #9A3412; }

.feature-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 139, 139, 0.06), transparent);
  transition: left 0.5s;
}

.feature-card:hover::before {
  left: 100%;
}

.feature-card:hover {
  transform: translateY(-8px);
  box-shadow: 0 20px 40px rgba(15, 23, 42, 0.15);
}

.feature-icon {
  margin-bottom: 24px;
  display: inline-block;
  padding: 20px;
  background: linear-gradient(135deg, #FFF3E0 0%, #FFE8D6 100%);
  border-radius: 20px;
}

.feature-title {
  font-size: 1.5rem;
  font-weight: 700;
  color: #1E293B;
  margin-bottom: 16px;
}

.feature-description {
  font-size: 1rem;
  line-height: 1.6;
  color: #475569;
}

/* í†µê³„ ì„¹ì…˜ */
.stats-section {
  padding: 80px 0;
  background: linear-gradient(135deg, #FFFAF0 0%, #FFF7EC 100%);
  color: #1E293B;
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 48px;
  text-align: center;
}

.stat-item {
  padding: 32px 16px;
}

.stat-number {
  font-size: 3rem;
  font-weight: 800;
  margin-bottom: 8px;
  color: #0F172A;
}

.stat-label {
  font-size: 1.125rem;
  opacity: 0.9;
  font-weight: 500;
  color: #334155;
}

/* ë°˜ì‘í˜• ë””ìì¸ */
@media (max-width: 1024px) {
  .home-content-wrapper {
    flex-direction: column;
    gap: 16px;
  }
  
  .home-main-content {
    padding-right: 0;
    margin-left: 20px;
    margin-right: 20px;
    max-width: 100%;
  }
  
  .home-sidebar {
    display: none;
  }
  
  .sidebar-card {
    min-width: 280px;
    flex-shrink: 0;
  }
  
  .hero-content {
    grid-template-columns: 1fr;
    gap: 48px;
    text-align: center;
  }
  
  .hero-title {
    font-size: 2.5rem;
  }
  
  .hero-actions {
    justify-content: center;
  }
  
  .pet-illustrations {
    width: 250px;
    height: 250px;
  }
  
  .pet {
    font-size: 60px;
  }
  
  .search-wrapper {
    width: calc(100% - 200px);
    max-width: 800px;
    padding: 0 24px;
    margin: 0 auto;
  }
}

@media (max-width: 768px) {
  .hero-title {
    font-size: 2rem;
  }
  
  .hero-subtitle {
    font-size: 1.125rem;
  }
  
  .hero-actions {
    flex-direction: column;
    align-items: center;
  }
  
  .hero-btn {
    width: 100%;
    max-width: 300px;
  }
  
  .section-title {
    font-size: 2rem;
  }
  
  .features-grid {
    grid-template-columns: 1fr;
  }
  
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
    gap: 32px;
  }
  
  .stat-number {
    font-size: 2.5rem;
  }
  
  .home-search-section {
    padding: 8px 0;
  }
  
  .home-content-wrapper {
    padding: 0 16px;
  }
  
  .home-main-content {
    padding-right: 0;
    margin-left: 10px;
    margin-right: 10px;
    max-width: 100%;
  }
  
  .search-wrapper {
    width: calc(100% - 100px);
    max-width: 700px;
    padding: 0 20px;
    justify-content: center;
    margin: 0 auto;
  }
  
  .search-and-write-container {
    gap: 12px;
  }
  
  .search-and-write-container :deep(.search-component) {
    flex: 1;
    min-width: 0;
  }
  

}

@media (max-width: 480px) {
  .hero-content {
    padding: 0 16px;
  }
  
  .home-content-wrapper {
    padding: 0 12px;
  }
  
  .home-main-content {
    padding-right: 0;
    margin-left: 5px;
    margin-right: 5px;
    max-width: 100%;
  }
  
  .container {
    padding: 0 16px;
  }
  
  .stats-grid {
    grid-template-columns: 1fr;
  }
  
  .home-search-section {
    padding: 5px 0;
  }
  
  .search-wrapper {
    width: calc(100% - 40px);
    max-width: 600px;
    padding: 0 16px;
    justify-content: center;
    margin: 0 auto;
  }
  
  .search-and-write-container {
    flex-direction: column;
    gap: 12px;
  }
  
  .search-and-write-container :deep(.search-component) {
    flex: 1;
    min-width: 0;
    width: 100%;
  }
  

}

/* ë‹¤í¬ ëª¨ë“œ ì§€ì› */
@media (prefers-color-scheme: dark) {
  /* ë‹¤í¬ ëª¨ë“œì—ì„œë„ ë™ì¼ íŒ”ë ˆíŠ¸ ìœ ì§€ */
  .features-section {
    background: linear-gradient(135deg, #FF8B8B 0%, #FFC1C1 100%);
  }
  .feature-card {
    background: #FFFFFF;
    border-color: rgba(0, 0, 0, 0.06);
  }
  .feature-title { color: #1E293B; }
  .feature-description { color: #475569; }
  .section-title { color: #FFFFFF !important; }
}

/* ëª¨ì…˜ ê°ì†Œ ì„¤ì • ì§€ì› */
@media (prefers-reduced-motion: reduce) {
  .shape,
  .pet,
  .hero-btn,
  .feature-card {
    animation: none;
    transition: none;
  }
  
  .hero-btn:hover,
  .feature-card:hover {
    transform: none;
  }
}
</style>
